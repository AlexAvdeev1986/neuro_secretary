–ö–æ–¥ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π Telegram-–±–æ—Ç–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ —Å–æ–≤–µ—â–∞–Ω–∏–π. –†–∞–∑–±–µ—Ä–µ–º –µ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã:

---

### **1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
```python
import sys, os, logging, hashlib, asyncio
from dotenv import load_dotenv
import openai, whisper, yt_dlp, numpy as np, noisereduce as nr, soundfile as sf
from telegram import Update
from telegram.ext import Application, CommandHandler, MessageHandler, filters - –≠—Ç–∞ —Å—Ç—Ä–æ–∫–∞ –∫–æ–¥–∞ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏–∑ –º–æ–¥—É–ª—è telegram.ext (—á–∞—Å—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ python-telegram-bot) —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

Application
–û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞—ë—Ç –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º-–±–æ—Ç–æ–º. –û–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–æ–≥–∏–∫—É –∑–∞–ø—É—Å–∫–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ö–æ–¥—è—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (updates) –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∏—Å–ø–µ—Ç—á–µ—Ä–æ–º (dispatcher) –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.

CommandHandler
–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è —Å —Å–∏–º–≤–æ–ª–∞ ¬´/¬ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, /start, /help). –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ç–∞–∫–æ–π –∫–æ–º–∞–Ω–¥—ã –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —É–∫–∞–∑–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫.

MessageHandler
–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –æ–±—ã—á–Ω—ã—Ö (–Ω–µ –∫–æ–º–∞–Ω–¥–Ω—ã—Ö) —Å–æ–æ–±—â–µ–Ω–∏–π, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Ç–µ–∫—Å—Ç, –∞—É–¥–∏–æ, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —Ç.–¥. –° –ø–æ–º–æ—â—å—é —Ñ–∏–ª—å—Ç—Ä–æ–≤ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å, –∫–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å.

filters
–ú–æ–¥—É–ª—å, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π –Ω–∞–±–æ—Ä —Ñ–∏–ª—å—Ç—Ä–æ–≤ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, filters.TEXT, filters.AUDIO –∏ —Ç.–¥.). –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–æ—á–Ω–æ –∑–∞–¥–∞–≤–∞—Ç—å, –∫–∞–∫–∏–µ —Ç–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫.

–≠—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤–º–µ—Å—Ç–µ –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –≥–∏–±–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∫–æ–º–∞–Ω–¥ –≤ Telegram-–±–æ—Ç–∞—Ö, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –∏ —É–¥–æ–±—Å—Ç–≤–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞.

load_dotenv()
openai.api_key = os.getenv("OPENAI_API_KEY")
TELEGRAM_TOKEN = os.getenv("TELEGRAM_TOKEN")
```
- **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏**:
  - `whisper` ‚Üí —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏.
  - `yt-dlp` ‚Üí —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –∞—É–¥–∏–æ —Å YouTube.
  - `noisereduce` ‚Üí –æ—á–∏—Å—Ç–∫–∞ –∞—É–¥–∏–æ –æ—Ç —à—É–º–æ–≤.
  - `python-telegram-bot` ‚Üí –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Telegram API.
- **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**:
  - –ö–ª—é—á–∏ OpenAI –∏ Telegram –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–∞ `.env`.

---

### **2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ**
#### **–ö–ª–∞—Å—Å `AudioProcessor`**
```python
class AudioProcessor:
    @staticmethod
    def download_youtube_audio(url: str) -> str: ...
    
    @staticmethod
    def clean_audio(input_path: str) -> str: ...
```
- **–ú–µ—Ç–æ–¥—ã**:
  1. `download_youtube_audio`:
     - –°–∫–∞—á–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ –∏–∑ YouTube –≤ —Ñ–æ—Ä–º–∞—Ç–µ WAV.
     - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É `yt-dlp`.
  2. `clean_audio`:
     - –£–¥–∞–ª—è–µ—Ç —à—É–º—ã —á–µ—Ä–µ–∑ `noisereduce`.
     - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ—á–∏—â–µ–Ω–Ω–æ–µ –∞—É–¥–∏–æ –≤ –Ω–æ–≤—ã–π —Ñ–∞–π–ª.

---

### **3. –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞**
#### **–ö–ª–∞—Å—Å `MeetingProcessor`**
```python
class MeetingProcessor:
    def __init__(self):
        self.whisper = whisper.load_model(WHISPER_MODEL)
        
    def transcribe(self, audio_path: str) -> str: ...
    
    @staticmethod
    def analyze_text(text: str) -> str: ...
    
    @staticmethod
    def generate_protocol(analysis: str) -> str: ...
```
- **–ú–µ—Ç–æ–¥—ã**:
  1. `transcribe`:
     - –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∞—É–¥–∏–æ –≤ —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ Whisper.
  2. `analyze_text`:
     - –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ GPT-4 Turbo (temperature=0.2).
     - –í—ã–¥–µ–ª—è–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –≤–æ–ø—Ä–æ—Å—ã, —Ä–µ—à–µ–Ω–∏—è.
  3. `generate_protocol`:
     - –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∞–Ω–∞–ª–∏–∑ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª —á–µ—Ä–µ–∑ GPT-4 Turbo (temperature=0.5).

---

### **4. Telegram-–±–æ—Ç**
#### **–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π**
```python
async def handle_audio(update: Update, context):
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ—Ñ–∞–π–ª–∞
    # 1. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ
    # 2. –û—á–∏—Å—Ç–∫–∞
    # 3. –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è
    # 4. –ê–Ω–∞–ª–∏–∑
    # 5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
    # 6. –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

async def handle_youtube(update: Update, context):
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ YouTube-—Å—Å—ã–ª–∫–∏
    # –ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ —à–∞–≥–∏, –Ω–æ —Å –∑–∞–≥—Ä—É–∑–∫–æ–π –∞—É–¥–∏–æ —á–µ—Ä–µ–∑ yt-dlp

async def start(update: Update, context):
    # –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
```
- **–õ–æ–≥–∏–∫–∞**:
  - –ë–æ—Ç –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∞—É–¥–∏–æ—Ñ–∞–π–ª—ã –∏–ª–∏ YouTube-—Å—Å—ã–ª–∫–∏.
  - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –≤ –ø–∞–ø–∫–µ `audio_cache`.
  - –ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª—ã —É–¥–∞–ª—è—é—Ç—Å—è.

---

### **5. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞**
```python
def main():
    application = Application.builder().token(TELEGRAM_TOKEN).build()
    application.add_handler(CommandHandler("start", start))
    application.add_handler(MessageHandler(filters.AUDIO, handle_audio))
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_youtube))
    application.run_polling()
```
- –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è:
  - –ö–æ–º–∞–Ω–¥—ã `/start`.
  - –ê—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤.
  - –¢–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (YouTube-—Å—Å—ã–ª–æ–∫).

---

### **6. –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**
- **–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ GPT-4**:
  - `0.2` –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ (–º–∏–Ω–∏–º—É–º —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏, –º–∞–∫—Å–∏–º—É–º —Ç–æ—á–Ω–æ—Å—Ç–∏).
  - `0.5` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ (–±–∞–ª–∞–Ω—Å –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã).
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**:
  - –í—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `logger.error`.
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –≤ Telegram.
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**:
  - –ê—É–¥–∏–æ—Ñ–∞–π–ª—ã –≤—Ä–µ–º–µ–Ω–Ω–æ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `audio_cache`.
  - –ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª—ã —É–¥–∞–ª—è—é—Ç—Å—è.

---

### **–ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å**
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   pip install python-telegram-bot openai whisper-openai yt-dlp noisereduce soundfile numpy python-dotenv
   ```
2. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:
   ```ini
   OPENAI_API_KEY=–≤–∞—à_–∫–ª—é—á_openai
   TELEGRAM_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_botfather
   ```
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:
   ```bash
   python main.py
   ```

---

### **–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã**
1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É –∞—É–¥–∏–æ—Ñ–∞–π–ª:
   ```
   ü§ñ –ü—Ä–æ—Ç–æ–∫–æ–ª –≥–æ—Ç–æ–≤:

   –£—á–∞—Å—Ç–Ω–∏–∫–∏:
   - –ò–≤–∞–Ω (–º–µ–Ω–µ–¥–∂–µ—Ä)
   - –ê–Ω–Ω–∞ (—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫)

   –ü–æ–≤–µ—Å—Ç–∫–∞:
   1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è API
   2. –°—Ä–æ–∫–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

   –†–µ—à–µ–Ω–∏—è:
   1. –£–≤–µ–ª–∏—á–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞ API (–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ê–Ω–Ω–∞, –°—Ä–æ–∫: 25.05.2024).
   ```
2. –ò–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ YouTube-—Å—Å—ã–ª–∫—É:
   ```
   üé• –ü—Ä–æ—Ç–æ–∫–æ–ª –∏–∑ YouTube-–≤–∏–¥–µ–æ:

   –£—á–∞—Å—Ç–Ω–∏–∫–∏:
   - –î–æ–∫–ª–∞–¥—á–∏–∫: –ê–ª–µ–∫—Å–µ–π –ü–µ—Ç—Ä–æ–≤
   - –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä: –û–ª—å–≥–∞ –°–º–∏—Ä–Ω–æ–≤–∞

   –ü–æ–≤–µ—Å—Ç–∫–∞:
   1. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –ò–ò –≤ –ª–æ–≥–∏—Å—Ç–∏–∫—É.
   ...
   ```

–ö–æ–¥ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é, –Ω–æ –¥–ª—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞ (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫, —É–ª—É—á—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏).
